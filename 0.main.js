webpackJsonp([0],{324:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},m=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),b=o(58),g=o(328),v=o(10),_=r(v),O=o(333),k=r(O),E=o(336),T=r(E),j=o(338),w=r(j),R=o(339),C=r(R),S=o(340),P=r(S),N=o(341),M=r(N),H=o(342),I=r(H),D={Main:{displayName:"Main"}},L=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Topic.js",components:D,locals:[e],imports:[f.default]}),x=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Topic.js",components:D,locals:[],imports:[f.default,p.default]}),B=function(e){return function(t){return L(x(t,e),e)}}("Main")(function(e){function t(e){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state={topic:{data:o.props.topic.data,id:o.props.topic.id},replies:o.props.topic.data?o.props.topic.isReverseReplies?[].concat(o.props.topic.data.replies).reverse():o.props.topic.data.replies:[],replyOrderClass:o.props.topic.replyOrderClass,replyOrderHeight:o.props.topic.replyOrderHeight,isLoadFail:!1},o.orderBtnClass={early:"",new:""},o.setBeyondReplyClass=o.setBeyondReplyClass.bind(o),o.getReplyToTopHeight=o.getReplyToTopHeight.bind(o),o.loadData=o.loadData.bind(o),window.addEventListener("scroll",o.setBeyondReplyClass,!1),o}return i(t,e),m(t,[{key:"checkLink",value:function(e,t){if("A"===e.target.nodeName){if("@"===e.target.innerHTML.charAt(0)){var o=e.target.innerHTML.substr(1);e.target.setAttribute("href","https://cnodejs.org/user/"+o)}e.target.setAttribute("target","_blank")}}},{key:"getReplyToTopHeight",value:function(e){function t(e,t){if(e)return e.currentStyle?e.currentStyle[t]:getComputedStyle(e)[t]}var o=parseInt(t(this._topicTitle,"height")),r=parseInt(t(this._topicBack,"height")),n=parseInt(t(this._topicContent,"height")),a=parseInt(t(this._topicReplyHead,"height")),i=parseInt(t(this._topicReplyOrder,"height"));return e?i:o+r+n+a-i}},{key:"setBeyondReplyClass",value:function(){var e=this.getReplyToTopHeight("getReplyOrderHeight"),t=this.getReplyToTopHeight();if((document.documentElement.scrollTop||document.body.scrollTop)>t){if(this.state.replyOrderHeight)return;this.props.dispatch({type:"SET_TOPIC_REPLY_ORDER",payload:{replyOrderClass:" topic-reply-order-beyond",replyOrderHeight:e+"px"}}),this.setState({replyOrderClass:this.props.topic.replyOrderClass,replyOrderHeight:this.props.topic.replyOrderHeight})}else{if(!this.state.replyOrderHeight)return;this.props.dispatch({type:"SET_TOPIC_REPLY_ORDER",payload:{replyOrderClass:"",replyOrderHeight:0}}),this.setState({replyOrderClass:this.props.topic.replyOrderClass,replyOrderHeight:this.props.topic.replyOrderHeight})}}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"loadData",value:function(e,t){var o=this,r=JSON.parse(localStorage.getItem(this.props.login.localStorageKey)),n=r?"?accesstoken="+r.accessToken:"";(0,g.fetchJSON)({url:"/topic/"+(e+n),success:function(e){t?(o.props.dispatch({type:"SET_TOPIC_INIT",payload:{id:e.data.id,data:e.data,isReverseReplies:o.props.topic.isReverseReplies}}),o.setState({replies:o.props.topic.isReverseReplies?[].concat(o.props.topic.data.replies).reverse():o.props.topic.data.replies})):(o.props.dispatch({type:"SET_TOPIC_INIT",payload:{id:e.data.id,data:e.data,isReverseReplies:!1}}),o.setState({topic:{data:o.props.topic.data,id:o.props.topic.id},replies:o.props.topic.data.replies,isLoadFail:!1}))},fail:function(){o.setState({isLoadFail:!0})}})}},{key:"render",value:function(){function e(e,t){this.props.dispatch({type:"SET_REPLIES_IS_REVERSE",payload:{isReverseReplies:t}}),this.setState({replies:t?[].concat(e).reverse():e}),this.state.replyOrderHeight&&(document.documentElement.scrollTop=document.body.scrollTop=this.getReplyToTopHeight())}var t=this,o=localStorage.getItem(this.props.login.localStorageKey);return this.state.topic.data?f.default.createElement("div",null,f.default.createElement(b.Route,{path:"/topic/:id/replies",render:function(e){return f.default.createElement(T.default,y({},e,{loadTopic:t.loadData,replyCommentData:t.props.topic.replyComment}))}}),f.default.createElement(k.default,{_commonBack:function(e){return t._topicBack=e}},f.default.createElement(b.Link,{to:o?this.props.location.pathname+"/replies":"/login",className:"topic-reply-btn fright",onClick:function(e){e.stopPropagation()}},"回复")),f.default.createElement(w.default,y({},this.props,{_topicTitle:function(e){return t._topicTitle=e},getReplyToTopHeight:this.getReplyToTopHeight})),f.default.createElement(C.default,{_topicContent:function(e){return t._topicContent=e},checkLink:this.checkLink,createMarkup:this.createMarkup,data:this.props.topic.data}),f.default.createElement(P.default,{_topicReplyHead:function(e){return t._topicReplyHead=e},repliesLen:this.props.topic.data.replies.length}),f.default.createElement(M.default,y({},this.props,{replyOrderClass:this.state.replyOrderClass,_topicReplyOrder:function(e){return t._topicReplyOrder=e},setOrderTrue:function(){e.bind(t)(t.props.topic.data.replies,!0)},setOrderFalse:function(){e.bind(t)(t.props.topic.data.replies,!1)}})),f.default.createElement(I.default,y({},this.props,{replies:this.state.replies,replyOrderHeight:this.state.replyOrderHeight,checkLink:this.checkLink,createMarkup:this.createMarkup,loadTopic:this.loadData}))):f.default.createElement(_.default,{isLoadFail:this.state.isLoadFail})}},{key:"componentDidMount",value:function(){var e=this.state.topic.id,t=this.props.match.params.id;document.documentElement.scrollTop=document.body.scrollTop=this.props.topic.scrollTop,this.state.topic.data&&e===t||(this.setState({topic:{data:null,id:""}}),this.loadData(t))}},{key:"componentWillUnmount",value:function(){var e=document.documentElement.scrollTop||document.body.scrollTop;this.props.dispatch({type:"SET_TOPIC_SCROLL_TOP",payload:{scrollTop:e}}),window.removeEventListener("scroll",this.setBeyondReplyClass,!1)}}]),t}(u.Component));t.default=B}).call(t,o(21)(e))},328:function(e,t,o){"use strict";function r(e){console.log(e)}function n(e){console.log("出错: \n",e)}function a(e){if(!e.ok)throw Error(e.statusText);return e}function i(e){return e.json()}function c(e){return e.text()}function p(e){console.log(e)}function l(e){var t=e.url,o=e.success,r=e.req,c=e.fail;fetch(f+t,r).then(a).then(i).then(o).catch(c||n)}function s(e){fetch(e).then(a).then(c).then(r).catch(n)}function u(){fetch.apply(void 0,arguments).then(a).then(p).catch(n)}Object.defineProperty(t,"__esModule",{value:!0});var f="https://cnodejs.org/api/v1";t.fetchJSON=l,t.fetchText=s,t.backResponse=u},329:function(e,t,o){"use strict";function r(e){switch(e.arrayFormat){case"index":return function(t,o,r){return null===o?[a(t,e),"[",r,"]"].join(""):[a(t,e),"[",a(r,e),"]=",a(o,e)].join("")};case"bracket":return function(t,o){return null===o?a(t,e):[a(t,e),"[]=",a(o,e)].join("")};default:return function(t,o){return null===o?a(t,e):[a(t,e),"=",a(o,e)].join("")}}}function n(e){var t;switch(e.arrayFormat){case"index":return function(e,o,r){if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t)return void(r[e]=o);void 0===r[e]&&(r[e]={}),r[e][t[1]]=o};case"bracket":return function(e,o,r){return t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0===r[e]?void(r[e]=[o]):void(r[e]=[].concat(r[e],o)):void(r[e]=o)};default:return function(e,t,o){if(void 0===o[e])return void(o[e]=t);o[e]=[].concat(o[e],t)}}}function a(e,t){return t.encode?t.strict?l(e):encodeURIComponent(e):e}function i(e){return Array.isArray(e)?e.sort():"object"==typeof e?i(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}function c(e){var t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){t=s({arrayFormat:"none"},t);var o=n(t),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^[?#&]/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),n=t.shift(),a=t.length>0?t.join("="):void 0;a=void 0===a?null:u(a),o(u(n),a,r)}),Object.keys(r).sort().reduce(function(e,t){var o=r[t];return Boolean(o)&&"object"==typeof o&&!Array.isArray(o)?e[t]=i(o):e[t]=o,e},Object.create(null))):r}var l=o(331),s=o(34),u=o(332);t.extract=c,t.parse=p,t.stringify=function(e,t){t=s({encode:!0,strict:!0,arrayFormat:"none"},t),!1===t.sort&&(t.sort=function(){});var o=r(t);return e?Object.keys(e).sort(t.sort).map(function(r){var n=e[r];if(void 0===n)return"";if(null===n)return a(r,t);if(Array.isArray(n)){var i=[];return n.slice().forEach(function(e){void 0!==e&&i.push(o(r,e,i.length))}),i.join("&")}return a(r,t)+"="+a(n,t)}).filter(function(e){return e.length>0}).join("&"):""},t.parseUrl=function(e,t){return{url:e.split("?")[0]||"",query:p(c(e),t)}}},331:function(e,t,o){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},332:function(e,t,o){"use strict";function r(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var o=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],r(o),r(n))}function n(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(i),o=1;o<t.length;o++)e=r(t,o).join(""),t=e.match(i);return e}}function a(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},o=c.exec(e);o;){try{t[o[0]]=decodeURIComponent(o[0])}catch(e){var r=n(o[0]);r!==o[0]&&(t[o[0]]=r)}o=c.exec(e)}t["%C2"]="�";for(var a=Object.keys(t),i=0;i<a.length;i++){var p=a[i];e=e.replace(new RegExp(p,"g"),t[p])}return e}var i=new RegExp("%[a-f0-9]{2}","gi"),c=new RegExp("(%[a-f0-9]{2})+","gi");e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return a(e)}}},333:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),m={Main:{displayName:"Main"}},b=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/common/back.js",components:m,locals:[e],imports:[f.default]}),g=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/common/back.js",components:m,locals:[],imports:[f.default,p.default]}),v=function(e){return function(t){return b(g(t,e),e)}}("Main")(function(e){function t(e){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.goBack=o.goBack.bind(o),o}return i(t,e),y(t,[{key:"goBack",value:function(e){if(e.stopPropagation(),this.props.path)return this.props.history.push(this.props.path);history.go(-1)}},{key:"toTop",value:function(){document.documentElement.scrollTop=document.body.scrollTop=0}},{key:"render",value:function(){return f.default.createElement("div",{className:"common-back-container"},f.default.createElement("div",{className:"common-back hei clear "+(this.props.additionalClass||""),onClick:this.toTop,ref:this.props._commonBack},f.default.createElement("span",{className:"common-back-btn common-back-icon-font",onClick:this.goBack},""),this.props.children),f.default.createElement("div",{className:"hei"}))}}]),t}(u.Component));t.default=v}).call(t,o(21)(e))},336:function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),a=(r(n),o(11)),i=r(a),c=o(8),p=o(10),l=r(p),s=(0,i.default)({loader:function(){return o.e(5).then(o.bind(null,337))},loading:l.default}),u=function(e){return{localStorageKey:e.login.localStorageKey}},f=function(e){return{dispatch:function(t){e(t)}}};t.default=(0,c.connect)(u,f)(s)},338:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),m=o(328),b={Detail:{displayName:"Detail"}},g=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Detail.js",components:b,locals:[e],imports:[f.default]}),v=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Detail.js",components:b,locals:[],imports:[f.default,p.default]}),_=function(e){return function(t){return g(v(t,e),e)}}("Detail")(function(e){function t(e){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state={isCollect:o.props.topic.data.is_collect},o.setCollect=o.setCollect.bind(o),o}return i(t,e),y(t,[{key:"setCollect",value:function(){var e=this,t=JSON.parse(localStorage.getItem(this.props.login.localStorageKey));if(t){var r=t.accessToken,n=o(329),a=n.stringify({accesstoken:r,topic_id:this.props.match.params.id});(0,m.fetchJSON)({url:this.state.isCollect?"/topic_collect/de_collect":"/topic_collect/collect",req:{method:"post",body:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}},success:function(t){e.setState({isCollect:!e.state.isCollect}),e.props.dispatch({type:"SET_TOPIC_IS_COLLECT",payload:e.state.isCollect})}})}else this.props.history.push("/login")}},{key:"render",value:function(){var e=this,t=JSON.parse(localStorage.getItem(this.props.login.localStorageKey));return f.default.createElement("div",{className:"topic-title",ref:this.props._topicTitle},f.default.createElement("h3",null,this.props.topic.data.title),f.default.createElement("div",{className:"topic-detail clear"},f.default.createElement("span",null,"回复：",this.props.topic.data.reply_count?f.default.createElement("a",{className:"active",onClick:function(){document.documentElement.scrollTop=document.body.scrollTop=e.props.getReplyToTopHeight()}},this.props.topic.data.reply_count):this.props.topic.data.reply_count),f.default.createElement("span",null,"阅读：",this.props.topic.data.visit_count),t?f.default.createElement("a",{className:"active fright",onClick:this.setCollect},this.state.isCollect?"已收藏":"收藏"):null,f.default.createElement("span",{className:"fright"},this.props.getDuration(this.props.topic.data.create_at)),f.default.createElement("span",{className:"fright"},this.props.topic.data.author.loginname)))}}]),t}(u.Component));t.default=_}).call(t,o(21)(e))},339:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),m={Content:{displayName:"Content"}},b=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Content.js",components:m,locals:[e],imports:[f.default]}),g=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Content.js",components:m,locals:[],imports:[f.default,p.default]}),v=function(e){return function(t){return b(g(t,e),e)}}("Content")(function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),y(t,[{key:"render",value:function(){var e=this;return f.default.createElement("div",{className:"topic-content",ref:this.props._topicContent,onMouseOver:function(t){e.props.checkLink(t)},dangerouslySetInnerHTML:this.props.createMarkup(this.props.data.content)})}}]),t}(u.Component));t.default=v}).call(t,o(21)(e))},340:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),m={ReplyHead:{displayName:"ReplyHead"}},b=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/ReplyHead.js",components:m,locals:[e],imports:[f.default]}),g=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/ReplyHead.js",components:m,locals:[],imports:[f.default,p.default]}),v=function(e){return function(t){return b(g(t,e),e)}}("ReplyHead")(function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),y(t,[{key:"render",value:function(){return f.default.createElement("div",{className:"topic-reply-head",ref:this.props._topicReplyHead},f.default.createElement("span",{className:"topic-reply-outer"},this.props.repliesLen," 回复"))}}]),t}(u.Component));t.default=v}).call(t,o(21)(e))},341:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),m={ReplyOrder:{displayName:"ReplyOrder"}},b=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/ReplyOrder.js",components:m,locals:[e],imports:[f.default]}),g=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/ReplyOrder.js",components:m,locals:[],imports:[f.default,p.default]}),v=function(e){return function(t){return b(g(t,e),e)}}("ReplyOrder")(function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),y(t,[{key:"render",value:function(){return this.orderBtnClass={early:this.props.topic.isReverseReplies?"":" active",new:this.props.topic.isReverseReplies?" active":""},f.default.createElement("div",{className:"topic-reply-order clear"+this.props.replyOrderClass,ref:this.props._topicReplyOrder,style:{display:this.props.topic.data.replies.length?"":"none"}},f.default.createElement("span",{className:"topic-reply-order-btn fright"+this.orderBtnClass.new,onClick:this.props.setOrderTrue},"最新"),f.default.createElement("span",{className:"topic-reply-order-btn fright"+this.orderBtnClass.early,onClick:this.props.setOrderFalse},"最早"))}}]),t}(u.Component));t.default=v}).call(t,o(21)(e))},342:function(e,t,o){"use strict";(function(e){function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(55),p=r(c),l=o(56),s=r(l),u=o(0),f=r(u),d=o(57),h=r(d),y=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),m=o(58),b=o(328),g={Replies:{displayName:"Replies"}},v=(0,h.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Replies.js",components:g,locals:[e],imports:[f.default]}),_=(0,s.default)({filename:"D:/work/projects/cnode-demo/app/components/Topic/Replies.js",components:g,locals:[],imports:[f.default,p.default]}),O=function(e){return function(t){return v(_(t,e),e)}}("Replies")(function(e){function t(e){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.setUps=o.setUps.bind(o),o}return i(t,e),y(t,[{key:"setReplyComment",value:function(e){this.props.dispatch({type:"SET_REPLY_COMMENT",payload:{reply_id:e.id,author:e.author.loginname}})}},{key:"setUps",value:function(e){var t=this,o=JSON.parse(localStorage.getItem(this.props.login.localStorageKey));o?(0,b.fetchJSON)({url:"/reply/"+e+"/ups",req:{method:"post",body:"accesstoken="+o.accessToken,headers:{"Content-Type":"application/x-www-form-urlencoded"}},success:function(o){for(var r="up"===o.action,n=t.props.topic.isReverseReplies,a=0;a<t.props.replies.length;a++)if(t.props.replies[a].id===e){t.props.replies[a].is_uped=r,r?t.props.replies[a].ups.push("tem_token"):t.props.replies[a].ups.pop(),t.props.dispatch({type:"SET_TOPIC_REPLIES",payload:n?[].concat(t.props.replies).reverse():t.props.replies});break}}}):this.props.history.push("/login")}},{key:"render",value:function(){var e=this,t=localStorage.getItem(this.props.login.localStorageKey);return f.default.createElement("div",null,this.props.replies?f.default.createElement("ul",{className:"topic-reply-list",style:{marginTop:this.props.replyOrderHeight}},this.props.replies.map(function(o,r){var n=void 0,a=void 0;return o.author.loginname===e.props.topic.data.author.loginname?(a="作者",n="topic-reply-num-active"):(a=e.props.topic.isReverseReplies?e.props.replies.length-r+"楼":r+1+"楼",n="topic-reply-num"),f.default.createElement("li",{key:o.id},f.default.createElement("img",{className:"topic-reply-avatar",src:o.author.avatar_url}),f.default.createElement("div",{className:"topic-reply-box"},f.default.createElement("div",{className:"topic-reply-detail clear"},f.default.createElement("a",{href:"https://cnodejs.org/user/"+o.author.loginname,target:"_blank",className:"topic-reply-username"},o.author.loginname),f.default.createElement("span",{className:"topic-reply-duration"},e.props.getDuration(o.create_at)),f.default.createElement("span",{className:n},a),f.default.createElement("span",{className:"topic-reply-up fright"+(o.ups.length?o.is_uped?" topic-reply-up-ownActive":" topic-reply-up-active":""),onClick:function(){e.setUps(o.id)}},f.default.createElement("span",{className:"topic-reply-upIcon"},""),o.ups.length)),f.default.createElement("div",{className:"topic-reply-content topic-content",onMouseOver:function(t){e.props.checkLink(t,e.props.topic.data.id)},dangerouslySetInnerHTML:e.props.createMarkup(o.content)}),f.default.createElement("div",null,f.default.createElement(m.Link,{to:t?e.props.location.pathname+"/replies":"/login",className:"topic-reply-reply fright",onClick:function(){e.setReplyComment(o)}},""))))})):null)}}]),t}(u.Component));t.default=O}).call(t,o(21)(e))}});